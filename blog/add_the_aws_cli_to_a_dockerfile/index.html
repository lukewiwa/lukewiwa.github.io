<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add the AWS CLI to a Dockerfile</title><link rel="stylesheet" href="https://unpkg.com/tachyons@4.12.0/css/tachyons.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.2/new.min.css"><link rel="stylesheet" href="/index.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/github.min.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/github-dark.min.css" media="screen and (prefers-color-scheme: dark)"></head><body><header><nav class="flex flex-row items-center justify-between"><a href="/" class="link nav-brand no-underline dtc w-25 f3">Wiwa</a><div class="dtc v-mid w-75 tr"><a href="/blog" class="link nav-link f6 f5-ns dib mr3 mr4-ns b">Blog</a><a href="/projects" class="link nav-link f6 f5-ns dib mr3 mr4-ns ">Projects</a></div></nav></header><main class="pt-4"><div><article><h1 class="f2">Add the AWS CLI to a Dockerfile</h1><time class="db mb1">2021-04-25</time><div><p>Using the magic of multi-stage builds using <a href="https://docs.docker.com/develop/develop-images/multistage-build/#use-an-external-image-as-a-stage">external images</a> and Amazon's official aws cli <a href="https://hub.docker.com/r/amazon/aws-cli">docker image</a> it's actually pretty easy to add the AWS CLI to a huge amount of containers.</p>
<!--more-->
<p>I haven't tested this on every single docker image out there but for my needs this is a quick and easy way to add the AWS CLI. Configuration can be done using environment variables so no need for mucking around with config files.</p>
<pre><code class="language-dockerfile hljs"><span class="hljs-keyword">ARG</span> IMAGE
<span class="hljs-keyword">FROM</span> ${IMAGE}

<span class="hljs-comment"># Install AWS CLI</span>
<span class="hljs-keyword">COPY</span><span class="language-bash"> --from=amazon/aws-cli:latest /usr/<span class="hljs-built_in">local</span>/aws-cli/ /usr/<span class="hljs-built_in">local</span>/aws-cli/</span>
<span class="hljs-keyword">RUN</span><span class="language-bash"> ln -s /usr/<span class="hljs-built_in">local</span>/aws-cli/v2/current/bin/aws \
        /usr/<span class="hljs-built_in">local</span>/bin/aws &amp;&amp; \
    ln -s /usr/<span class="hljs-built_in">local</span>/aws-cli/v2/current/bin/aws_completer \
        /usr/<span class="hljs-built_in">local</span>/bin/aws_completer</span>
</code></pre>
</div></article></div></main></body></html>