<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Importing Rootfs Ubuntu Images into WSL2 | Wiwa</title>
    <meta name="description" content="">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon.png">
  <link rel="icon" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/assets/css/0.styles.2bdfcac1.css" as="style"><link rel="preload" href="/assets/js/app.37828bcd.js" as="script"><link rel="preload" href="/assets/js/8.8bae9f49.js" as="script"><link rel="preload" href="/assets/js/32.5ee80c19.js" as="script"><link rel="prefetch" href="/assets/js/1.e601703c.js"><link rel="prefetch" href="/assets/js/10.fbaeed83.js"><link rel="prefetch" href="/assets/js/11.b10ea0fd.js"><link rel="prefetch" href="/assets/js/12.9401ce5e.js"><link rel="prefetch" href="/assets/js/13.dc772007.js"><link rel="prefetch" href="/assets/js/14.2d62742c.js"><link rel="prefetch" href="/assets/js/15.c76c9299.js"><link rel="prefetch" href="/assets/js/16.379f1762.js"><link rel="prefetch" href="/assets/js/17.e6790c21.js"><link rel="prefetch" href="/assets/js/18.da914e29.js"><link rel="prefetch" href="/assets/js/19.14739d05.js"><link rel="prefetch" href="/assets/js/20.5de463a4.js"><link rel="prefetch" href="/assets/js/21.43d14bd5.js"><link rel="prefetch" href="/assets/js/22.dc994baf.js"><link rel="prefetch" href="/assets/js/23.8552cb55.js"><link rel="prefetch" href="/assets/js/24.88309ce8.js"><link rel="prefetch" href="/assets/js/25.01942dbe.js"><link rel="prefetch" href="/assets/js/26.324ebbca.js"><link rel="prefetch" href="/assets/js/27.06d5fa22.js"><link rel="prefetch" href="/assets/js/28.def440f8.js"><link rel="prefetch" href="/assets/js/29.0e3902a0.js"><link rel="prefetch" href="/assets/js/30.aa982b52.js"><link rel="prefetch" href="/assets/js/31.d665b62a.js"><link rel="prefetch" href="/assets/js/33.41bcc074.js"><link rel="prefetch" href="/assets/js/34.00f9f589.js"><link rel="prefetch" href="/assets/js/35.26aba812.js"><link rel="prefetch" href="/assets/js/36.c4e521e5.js"><link rel="prefetch" href="/assets/js/4.1019947a.js"><link rel="prefetch" href="/assets/js/5.bb471430.js"><link rel="prefetch" href="/assets/js/6.8c2ebfc3.js"><link rel="prefetch" href="/assets/js/7.a094427b.js"><link rel="prefetch" href="/assets/js/9.0aba9068.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.186923c0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2bdfcac1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/vuepress-blog-logo.png" alt="Wiwa" class="logo"> <span class="site-name can-hide">Wiwa</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/gymnastics/" class="nav-link">Gymnastics</a></div><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="/rss.xml" class="nav-link">RSS Feed</a></div> <a href="https://github.com/lukewiwa" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/gymnastics/" class="nav-link">Gymnastics</a></div><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="/rss.xml" class="nav-link">RSS Feed</a></div> <a href="https://github.com/lukewiwa" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <!----> </div> <div class="blog" data-v-e2fa6bc4><div class="blog__header" data-v-e2fa6bc4><h1 data-v-e2fa6bc4>Importing Rootfs Ubuntu Images into WSL2</h1> <p class="publish-date" data-v-e2fa6bc4><time datetime="2020-05-26T00:00:00.000Z" data-v-e2fa6bc4>May 26, 2020</time></p></div> <div class="custom content default" data-v-e2fa6bc4><p>I've been generally impressed with the preview of Windows Subsystem for Linux 2 (WSL2) and it's integration between the windows desktop and the underlying linux kernel.</p> <p>I did notice on a <a href="https://www.youtube.com/watch?v=UCAid-NQwWU&amp;feature=youtu.be" target="_blank" rel="noopener noreferrer">talk by one of the main devs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> that you could manually import and export linux and container images. This seemed like a nice idea if you wanted to separate dev environments or perhaps have separate work or personal accounts. The demonstration showed exporting and importing docker containers and linux tarballs using the Cool New <code>wsl</code> command in powershell. My dilemma was that I had already setup one Ubuntu environment and wanted a clean one from scratch. So I did a little digging and managed to get one working with a few hiccups along the way.</p> <h1 id="_1-download-the-latest-rootfs-image"><a href="#_1-download-the-latest-rootfs-image" aria-hidden="true" class="header-anchor">#</a> 1. Download The Latest Rootfs Image</h1> <p>The Ubuntu wiki has a very neat <a href="https://wiki.ubuntu.com/WSL#Installing_Ubuntu_on_WSL_via_rootfs" target="_blank" rel="noopener noreferrer">guide<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> on how to import an image. Be sure to download the nightly image with the <code>-wsl.rootfs.tar.gz</code> suffix.</p> <h1 id="_2-import-the-image"><a href="#_2-import-the-image" aria-hidden="true" class="header-anchor">#</a> 2. Import The Image</h1> <p>As in the Ubuntu wiki run the command below. I decided to keep the image location in my home directory, in a <code>distro</code> folder.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>wsl --import <span class="token operator">&lt;</span>DistributionName<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>InstallLocation<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>FileName<span class="token operator">&gt;</span>
</code></pre></div><h1 id="_3-create-a-user"><a href="#_3-create-a-user" aria-hidden="true" class="header-anchor">#</a> 3. Create A User</h1> <p>Drop into the wsl2 instance by running the name of the distribution as a command in powershell, or by using the excellent new Windows Terminal app. By default the only user in the image is the root user. While the stock standard Ubuntu image you install from the Microsoft Store prompts you to create a user at startup we'll have to do the prompting ourselves here. The <code>adduser</code> command should get you what you need. <strong>Be sure to add your new user to the sudo group</strong>.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>adduser <span class="token operator">&lt;</span>username<span class="token operator">&gt;</span> --ingroup <span class="token function">sudo</span>
</code></pre></div><h1 id="_4-change-the-default-user"><a href="#_4-change-the-default-user" aria-hidden="true" class="header-anchor">#</a> 4. Change The Default User</h1> <p>Now that we have created the user we would like it to be the default user whenever you start a new shell. This is a little tricky and there's a <a href="https://github.com/Microsoft/WSL/issues/3974" target="_blank" rel="noopener noreferrer">github issue<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> outlining this pain point and some possible work arounds. I went with the powershell option but pick your poison.</p> <p>And that's it, enjoy separating those concerns.</p></div> <div class="page-edit" data-v-e2fa6bc4><!----> <!----></div> <!----> </div> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.37828bcd.js" defer></script><script src="/assets/js/8.8bae9f49.js" defer></script><script src="/assets/js/32.5ee80c19.js" defer></script>
  </body>
</html>
